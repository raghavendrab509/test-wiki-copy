buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath 'org.ajoberstar:grgit:1.6.0'
    }
}

ext {
    // Open the Git repository in the current directory.
    git = org.ajoberstar.grgit.Grgit.open(file('.'))

    // Get commit id of HEAD.
    revision = git.head().abbreviatedId
    
    //current branch
    branchName = git.branch.getCurrent().fullName.replace('/', '_')
    
    isRelease = (branchName != null) ? true : false
    mVersion = "0.0.6"
}

apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'maven'

// Change build directory so clean doesn't delete build/hooks
buildDir = 'gradle-build'

version = isRelease ? mVersion + '.' + branchName + '_' + revision : "0.0.6"
jar {
    baseName = "java-beans"
    version = version
}

repositories {
    mavenCentral()
}



uploadArchives {
    repositories {
        mavenDeployer {
            repository(url: "https://mavenrepo.forrent.com/repository/internal/") {
                 authentication(userName: "frc_maven_repo", password: "FRCarchive1")
            }
            pom.version = version
            pom.artifactId = "java-beans"
            pom.groupId = "com.forrent"
        }
    }
}

sourceCompatibility = 1.8
targetCompatibility = 1.8

// +-------+
// | Tasks |
// +-------+

task wrapper(type: Wrapper) {
    gradleVersion = '2.3'
}

task preDeploy << {
    println branchName
}

